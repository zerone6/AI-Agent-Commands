---
agent: agent
description: "자동화 테스트 실행 및 결과 보고"
---

자동화 테스트를 실행하고 결과를 분석하여 보고합니다.

## 목적

코드 변경 후 자동화된 테스트를 실행하여 기능의 정확성을 검증하고, 회귀 버그를 방지합니다.

## 트리거

- PLAN의 구현 완료 후 검증 단계
- PR 생성 전 테스트 확인이 필요할 때
- 사용자가 테스트 실행을 요청할 때
- CI/CD 파이프라인 시뮬레이션이 필요할 때
- 리팩토링 후 동작 검증이 필요할 때

## 결과물

### 결과 기록 위치

PLAN 파일에 테스트 결과 섹션 추가:

```markdown
## 테스트 결과

### 실행 정보
- 실행 일시: YYYY-MM-DD HH:MM (Asia/Tokyo)
- 테스트 범위: (전체 / 변경 파일 / 특정 모듈)
- 실행 환경: (Node v18, macOS 등)

### 요약
| 항목 | 결과 |
|------|------|
| 총 테스트 | N개 |
| 통과 | N개 (✅) |
| 실패 | N개 (❌) |
| 스킵 | N개 (⏭️) |
| 커버리지 | N% |
| 실행 시간 | N초 |

### 실패한 테스트 (해당 시)
| 테스트명 | 파일 | 에러 메시지 | 원인 분석 |
|---------|------|-----------|----------|
| testName | path/to/file.test.ts | Error message | 추정 원인 |

### 커버리지 상세
| 항목 | 비율 |
|------|------|
| Statements | N% |
| Branches | N% |
| Functions | N% |
| Lines | N% |

### 커버리지 미달 파일 (해당 시)
- /path/to/file.ts: N% (기준: 80%)

### 권장 조치
- (실패 테스트 수정 방안)
- (커버리지 개선 방안)
```

## 실행 순서

### Phase 1: 테스트 환경 확인

1. 테스트 설정 파일 확인
   - jest.config.js
   - pytest.ini
   - karma.conf.js 등
2. 테스트 의존성 설치 상태 확인
   ```bash
   npm ls --depth=0
   # 또는
   pip list
   ```
3. 테스트 데이터베이스/목업 준비 상태 확인
4. 환경 변수 설정 확인 (.env.test)

### Phase 2: 테스트 범위 결정

| 모드 | 조건 | 실행 범위 |
|------|------|----------|
| 변경 파일만 | 기본 | 변경된 파일 관련 테스트만 |
| 특정 모듈 | 사용자 지정 | 지정된 모듈/폴더 테스트 |
| 전체 | "전체 테스트" 지시 | 모든 테스트 실행 |

### Phase 3: 테스트 실행

1. 린트/타입 체크 (pre-test)
   ```bash
   npm run lint
   npm run type-check
   ```

2. 단위 테스트 실행
   ```bash
   npm run test:unit
   # 또는
   pytest tests/unit/
   # 또는
   swift test
   ```

3. 통합 테스트 실행 (해당 시)
   ```bash
   npm run test:integration
   ```

4. E2E 테스트 실행 (요청 시)
   ```bash
   npm run test:e2e
   # 또는
   cypress run
   ```

5. 커버리지 리포트 생성
   ```bash
   npm run test:coverage
   ```

### Phase 4: 결과 분석

테스트 결과를 분석하여 다음 항목 확인:

| 항목 | 기준 | 조치 |
|------|------|------|
| 테스트 통과율 | 100% | 실패 시 원인 분석 |
| 커버리지 | 프로젝트 기준 (예: 80%) | 미달 시 보고 |
| 실행 시간 | 이전 대비 증가 여부 | 10% 이상 증가 시 경고 |
| 플레이키 테스트 | 불안정한 테스트 | 목록화 및 개선 권고 |

**실패한 테스트 분석:**
1. 에러 메시지 수집
2. 실패 원인 분류
   - 코드 버그
   - 테스트 코드 문제
   - 환경 이슈
   - 플레이키 테스트
3. 수정 방안 제시

### Phase 5: 결과 보고

1. PLAN 파일에 테스트 결과 섹션 추가
2. 실패한 테스트가 있으면 즉시 사용자에게 보고
3. 커버리지 미달 파일 목록 제공
4. 권장 조치 사항 제시

## 테스트 유형

| 유형 | 도구 예시 | 실행 시점 |
|------|----------|----------|
| 단위 테스트 | Jest, JUnit, XCTest | 매 커밋 |
| 통합 테스트 | Supertest, TestContainers | PR 전 |
| E2E 테스트 | Cypress, Playwright, XCUITest | 릴리즈 전 |
| 스냅샷 테스트 | Jest Snapshot | UI 변경 시 |

## 실패 시 행동

| 상황 | 행동 |
|------|------|
| 테스트 실패 | 즉시 중단, 실패 원인 분석 후 보고 |
| 타임아웃 | 해당 테스트 식별, 원인 분석 |
| 환경 오류 | 환경 설정 문제 보고 |
| 플레이키 | 재실행 후에도 불안정하면 보고 |

**중요:** 테스트 실패 시 커밋하지 않습니다.

## 테스트 작성 가이드

새 기능 구현 시 테스트 작성 기준:

| 유형 | 필수 여부 | 작성 기준 |
|------|----------|----------|
| 단위 테스트 | 필수 | 모든 public 함수/메서드 |
| 통합 테스트 | 권장 | API 엔드포인트, DB 연동 |
| E2E 테스트 | 선택 | 핵심 사용자 플로우 |

**테스트 커버리지 기준:**
- 신규 코드: 80% 이상
- 기존 코드 수정: 기존 커버리지 유지 또는 개선
- Critical Path: 100%

## 주의사항

- 테스트 실패 시 코드 수정 전 원인 파악 우선
- 플레이키 테스트는 즉시 수정하거나 스킵 처리 후 TODO 등록
- 테스트 실패 시 커밋하지 않음
- 테스트 코드도 리뷰 대상
- 긴 E2E 테스트는 필요 시에만 실행
- 관련 문서: [CLAUDE.md](../../CLAUDE.md)

## 커밋 메시지 형식

```bash
test: <테스트 추가/수정 내용>

# 예시
test: add unit tests for auth service
test: update e2e tests for login flow
test: fix flaky test in user component
```
