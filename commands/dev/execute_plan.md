---
agent: agent
description: "작성된 PLAN을 바탕으로 코드 작성 실행"
---

승인된 PLAN 파일을 기반으로 Phase별 구현을 수행합니다.

## 목적

make_plan으로 작성된 PLAN을 실행 가능한 코드로 변환하고, 단계별 검증을 거쳐 완성된 기능을 구현합니다.

## 트리거

- PLAN 파일 승인 후 사용자가 구현 시작을 요청할 때
- 예시: "작성된 PLAN을 실행해줘", "Phase 1만 구현해줘"

## 결과물

### 파일 경로

- 구현된 소스 코드 파일들
- 업데이트된 PLAN 파일 (체크리스트, 결과 기록)

> 별도 결과 파일을 생성하지 않으며, PLAN 파일에 실행 결과를 기록합니다.

## 실행 순서

### Phase 0: 사전 확인

1. Git 상태 확인
   ```bash
   git status
   ```
   - 클린 상태 확인
   - 변경사항이 있으면 사용자에게 알림

2. Feature 브랜치 생성
   ```bash
   git checkout -b feature/<feature-name>
   ```
   - PLAN 내용 기반 브랜치명 결정
   - 이미 브랜치가 있으면 체크아웃

3. PLAN 파일 확인
   - 사용자 승인 완료 상태 확인
   - 최신 PLAN 파일 선택

### Phase 1: PLAN 파일 선택 및 모드 결정

1. PLAN 파일 선택
   - `/docs/current_sprint/` 에서 최신 PLAN 파일 선택
   - 정렬 기준: MMDD 내림차순 → NN 내림차순
   - 예: `plan122403.md` > `plan122402.md` > `plan122301.md`

2. 실행 모드 결정

| 모드       | 조건               | 동작                                                     |
| ---------- | ------------------ | -------------------------------------------------------- |
| 기본       | 특별 지시 없음     | 수동 테스트 필요 시점까지 진행 후 사용자에게 테스트 요청 |
| 특정 Phase | "Phase N까지" 지시 | 해당 Phase까지만 진행                                    |
| 전체       | "전체 구현" 지시   | 모든 Phase 완료                                          |

### Phase 2: Phase별 구현

각 Phase마다 다음 순서로 진행:

1. **Phase 시작 선언**
   - 현재 Phase 번호 및 목표 명시
   - PLAN 파일의 해당 Phase 내용 확인

2. **구현 수행**
   - PLAN의 추상화된 설계를 실제 코드로 변환
   - 파일 생성/수정/삭제 수행
   - 코드 작성 중 PLAN과 차이 발생 시 PLAN 업데이트

3. **자동화 테스트 실행** (해당 시)
   - API 테스트, 단위 테스트 등 실행
   - 테스트 실패 시 즉시 중단 및 보고

4. **PLAN 파일 체크리스트 업데이트**
   - 완료된 작업 체크 표시
   - 진행률 업데이트

5. **수동 테스트 필요 여부 확인**
   - 수동 테스트 필요 시 → 사용자에게 요청 후 대기
   - 결과 받은 후 다음 Phase 진행

### Phase 3: 실패 시 행동

| 상황            | 행동                                 |
| --------------- | ------------------------------------ |
| 테스트 실패     | 즉시 중단, 원인 분석 후 보고         |
| 구현 중 에러    | 중단, 에러 보고 형식에 따라 보고     |
| 요구사항 불명확 | 중단, 사용자에게 질문                |
| PLAN 변경 필요  | 변경 사항 설명 후 PLAN 업데이트 승인 |

에러 보고 형식은 [CLAUDE.md - 에러 처리](../../CLAUDE.md#9-에러-처리-및-보고) 참조

### Phase 4: 전체 완료 처리

모든 Phase 구현 완료 시:

1. **자동화 테스트 계획 작성**
   - AI Agent에 의한 자동화 테스트 계획 작성
   - JUnit, Jest, Pytest 등 자동화 테스트 계획
   - 사용자 확인 후 실행

2. **자동화 테스트 실행 및 결과 기록**
   - 테스트 실행
   - PLAN 파일에 결과 기록
     - 실행 리스트 일람
     - 성공 항목, 실패 항목
     - 실패 원인 및 대책

3. **PLAN 파일 업데이트**
   ```markdown
   ## 구현 결과

   ### 자동화 테스트 결과
   - 총 N개 테스트
   - 성공: N개
   - 실패: N개 (원인 및 대책 기재)

   ### 수동 테스트 항목
   - [ ] 테스트 항목 1
   - [ ] 테스트 항목 2

   ### 리스크 및 롤백
   - 발생한 이슈: ...
   - 롤백 방법: ...

   ### TODO
   - [ ] 추가 작업 항목
   ```

4. **사용자에게 완료 보고**
   - 구현 완료 알림
   - 수동 테스트 요청
   - 다음 단계 안내 (finish_plan)

## 주의사항

- **커밋 금지**: execute_plan 단계에서는 커밋하지 않음 (finish_plan에서 처리)
- **PLAN 준수**: PLAN의 추상화 수준과 설계 의도 유지
- **테스트 우선**: 각 Phase 완료 후 반드시 테스트 실행
- **중단 조건**: 에러 발생 시 즉시 중단, 사용자 보고
- **변경 기록**: PLAN과 다르게 구현된 부분은 PLAN 업데이트
- **보안 점검**: OWASP Top 10 기본 사항 확인 ([CLAUDE.md - 보안 규칙](../../CLAUDE.md#10-보안-규칙))

## 작업 중단 시

작업을 중단해야 하는 경우:
1. `save_temp` 커맨드 실행
2. 현재 상태 저장
3. WIP 커밋 생성

## 다음 단계

execute_plan 완료 후:
1. 사용자가 수동 테스트 완료 확인
2. `finish_plan` 커맨드로 문서화 및 커밋
3. PR 생성 (해당 시)
